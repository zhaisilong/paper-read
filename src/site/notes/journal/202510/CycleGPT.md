---
{"dg-publish":true,"permalink":"/journal/202510/CycleGPT/","tags":["GPT","Macrocyclic","JAK2","Transfer-learning"]}
---

# Commun. Chem. 2025 | CycleGPT: 利用深度学习模型探索大环化合物化学空间以启发式药物设计

今天介绍的是发表在**Communications Chemistry**上的一项工作——《利用深度学习模型探索大环化合物化学空间以启发式药物设计》。大环化合物兼具小分子与大分子药物的优点，因其独特的空间结构和高选择性结合能力，近年来成为药物研发的重要方向。然而，大环分子的结构优化仍受限于数据稀缺和构效关系复杂等问题。该研究提出的**CycleGPT模型**，以**渐进式迁移学习策略**结合**创新采样算法HyperTemp**，首次实现了从活性线性分子到大环分子、再到特定靶点化学空间的逐层迁移与生成。该模型不仅能进行**大环骨架跃迁与取代基修饰**，还可通过生成邻域化学空间的新分子进行启发式设计。在JAK2靶点研究中，CycleGPT成功发现多种高效大环抑制剂，其中化合物2表现出**优于临床药物Fedratinib与Pacritinib的选择性和体内疗效**，展示了深度学习在大环药物从头设计中的强大潜能与应用前景。

![](https://cdn.molastra.com/weixin/2025/10/11/6bf824a7c10e36feec35ae5f7527577e.jpg)

获取详情及资源:

- 论文: https://doi.org/10.1038/s42004-025-01686-w
- 代码: https://github.com/fengalbert/CycleGPT

## 0 摘要

大环化合物在治疗性分子中具有巨大潜力，但其结构优化长期受限于**活性候选分子的稀缺性**，这使得系统性地探索其构效关系变得困难。该研究提出一种专为解决此问题而设计的生成式化学语言模型——**CycleGPT**。该模型采用**渐进式迁移学习范式**，从预训练的化学语言模型逐步迁移知识至大环分子生成任务，从而有效缓解数据稀缺的问题。同时，CycleGPT引入了一种创新的**概率采样策略**，在提升生成分子结构新颖性的同时，确保其在特定化学领域的适应性。基于CycleGPT与JAK2活性预测模型的联合设计实验中，研究团队成功开发出一种新的JAK2候选药物，具备良好的选择性(抑制17种野生型激酶)，并在体内显示出治疗真性红细胞增多症的潜力，充分展示了深度学习方法在**大环药物设计中的实用价值**。

## 1 引言

创新药物研究在化学发展的推动下，旨在发现用于疾病治疗的高效分子。尽管**小分子化合物**（尤其是遵循Lipinski“五规则”的分子）仍是药物研发的核心，但其**结合界面有限、靶向亲和力不足**，常导致药物稳定性差、半衰期短以及脱靶效应等问题。为解决这些限制，研究者正积极探索**拓展药物可开发性化学空间的全新分子形式**，其中**大环化合物**因其独特的结构优势而成为突破传统小分子局限的有力候选。

大环化合物通常指**含有十二元环或更大环结构的环状化学分子或肽类**，介于小分子与抗体之间。这类结构能够与蛋白形成更大的接触界面，具备更高的结合亲和力与更强的选择性。此外，其独特的“变色龙特性”显著增强了药物稳定性，并赋予其优异的药代动力学特征。目前，大环化合物已成功用于多种药物靶点，如激酶、蛋白酶及G蛋白偶联受体，并在多种疾病治疗中展现出优异疗效。

理性的大环药物设计通常包括两个阶段：首先对具有生物活性的线性化合物进行**大环化反应**，随后对生成的大环分子进行**结构修饰与优化**。在大环化阶段，已有一些计算方法可通过几何约束的连接策略及预构建的三维连接数据库生成不同的大环骨架。此前，研究团队还提出了**Macformer模型**，通过基于子结构对齐的SMILES增强与Transformer架构，实现了大环连接子的自动生成。

然而，以**已有活性的大环化合物**为起点，如何进一步通过骨架跃迁或取代基修饰来提升药物可开发性、或扩充早期筛选候选库，仍是一项尚未解决的难题。目前此类优化主要依赖药物化学家的经验或药效团替换等迭代性方法，过程耗时且效率较低。典型案例是选择性CDK9抑制剂**Z11**的发现：研究者从线性前体Z0出发，经环化生成Z1，再经过三轮结构修饰，最终获得优化的大环化合物Z11，用于克服非小细胞肺癌中奥希替尼耐药性。尽管已有进展，但针对大环结构优化的**计算策略仍极为稀缺**。

全面解析**大环化合物复杂的化学空间**对于指导其结构优化至关重要。作为一种新兴且研究不足的结构类型，人类对大环分子的认知仍然有限，科学家们仍在探索**哪些分子特征**能使其更适合药物开发。Viarengo-Baker等人通过主成分分析发现了可用于设计口服大环化合物的13个关键性质；而Jimenez等人系统分析了FDA批准的大环药物，并提出了一个简单的双参数筛选模型——氢键供体≤7，且分子量<1000或cLogP>2.5——用于初步筛选口服大环候选物。然而，由于大环结构的复杂性及药物样本的稀缺，这类显式描述符对药物设计的指导仍非常有限。

为此，该研究提出探索**领先大环化合物邻域化学空间**的思路，这些区域可能蕴含新的潜在药物候选。研究团队引入了**CycleGPT**——一种专门用于系统探索和扩展优选大环化合物化学空间的生成式分子模型。CycleGPT采用**渐进式迁移学习框架**，逐步将预训练化学语言模型的知识迁移到大环分子生成任务中，从而缓解目标领域的数据稀缺问题。模型能够高效地从特权大环化合物的邻域化学空间中采样，将“结构修饰”问题转化为“化学空间探索”问题。

此外，CycleGPT引入了一种生成采样算法——**HyperTemp**，通过动态平衡高概率与低概率Token的选择，实现**结构新颖性与生成合理性**之间的优越平衡。基于CycleGPT，研究者在此前Macformer模型生成的大环基础上，对JAK2靶点进行了前瞻性药物设计，成功发现三种高效大环JAK2抑制剂，其IC₅₀分别为1.65 nM、1.17 nM与5.41 nM。其中一种化合物的激酶选择性优于上市药物Fedratinib与Pacritinib，并能在小鼠模型中以更低剂量抑制红细胞增多症与脾肿大。

这些成果充分表明，**CycleGPT在大环药物发现领域具有显著潜力**，为复杂化合物设计提供了深度学习驱动的创新路径。

![](https://cdn.molastra.com/weixin/2025/10/11/7d07259255a1ff010df1652d040cd410.jpg)

**图1 | CycleGPT总体概览** **a** CycleGPT的模型架构。**b** CycleGPT的训练流程。模型采用**渐进式迁移学习策略**：首先利用生物活性分子进行预训练；其次在大环化合物数据上进行迁移微调；最后在针对JAK2靶点的下游任务中进一步精调模型。**c, d** 分子UMAP可视化结果，用于展示化学空间的迁移过程。在迁移学习的三个阶段中，各随机选取1000个生成分子进行可视化。从结果可见，模型能够**从活性线性化合物空间逐步迁移至大环化合物空间**，并进一步迁移至**JAK2相关的大环化合物空间**，表明CycleGPT实现了化学空间的有效转移与特定靶点适配。

## 2 结果

### 2.1 模型概述

近年来，基于GPT的模型在各类序列处理任务中表现出**卓越的性能**。为了探索大环化合物的化学空间，研究团队基于**渐进式迁移学习策略**开发了名为**CycleGPT**的模型。该模型能够以**高效的字符级方式**理解并生成化学语言表示，从而有效地在**特权大环化合物的邻域化学空间中采样**，并探索潜在的新型大环药物候选物。

针对**大环分子数量稀缺**的挑战，CycleGPT首先在包含**365,063个具有生物活性标注的化合物**上进行了预训练，以学习SMILES的语义特征。这些分子来自ChEMBL数据库，其IC₅₀/EC₅₀/Kd/Ki值均小于1 μM，且SMILES长度少于140个字符。随后，研究团队从ChEMBL与DrugBank数据库中收集了**19,920个SMILES长度小于140字符的大环分子**，用于在预训练CycleGPT基础上进行迁移学习，从而实现**从线性活性分子化学空间向大环化合物化学空间的知识迁移**。在此基础上，模型还可进一步通过特定靶点的大环活性分子进行微调，以实现**靶向药物设计**（如图1a、b所示）。在参数优化方面，模型采用**Lion优化器**进行网络训练。

在分子生成过程中，**采样算法与网络结构**共同决定生成SMILES的质量。然而，现有采样算法在处理大环SMILES时仍存在挑战，尤其难以在**分子新颖性与有效性之间取得平衡**。为此，该研究提出了一种**启发式采样算法——HyperTemp**。该算法基于**温度采样（tempered sampling）策略**，能够对Token概率进行细粒度调控：通过**适度降低最优Token的概率**并**提升次优Token的概率**，以增强生成分子的结构新颖性，同时保持其化学合理性。

CycleGPT将HyperTemp采样机制与其语言模型架构相结合，构建了一个完整的大环生成框架，并**系统性地对比了HyperTemp与现有采样算法的性能差异**。此外，为验证该采样转化策略的有效性与合理性，研究团队还设计了三种不同的概率调整方法，与HyperTemp进行了**对照实验**（补充公式1–3）。

总体而言，这项工作是**首批系统探索大环分子生成采样算法**的研究之一，为这一长期被忽视但极具潜力的化学子类提供了重要的**方法论突破与技术基础**。

**表1｜CycleGPT-HyperTemp与其他模型的性能对比**

![](https://cdn.molastra.com/weixin/2025/10/11/f62d0250a96b95b01ac8d1a67ff0df38.jpg)

### 2.2 模型性能

研究对**CycleGPT-HyperTemp**的性能进行了系统评估，并与其他分子生成方法进行了对比(结果见表1)。除关注**生成有效性(validity)与大环比例(macrocycle_ratio)外，研究特别强调了一个综合性指标——novel_unique_macrocycles，用于衡量生成的大环分子中，既有效且独特、且未出现在训练集中的分子比例**。

结果显示，Char_RNN虽能生成足够多的有效大环分子，但其novel_unique_macrocycles仅为**11.76%**，新颖性极低；而基于GPT的MolGPT与cMolGPT则未能有效捕捉大环分子的语义特征。相比之下，Llamol与MTMol-GPT在新颖大环生成指标上表现更佳(分别为**38.13%与31.09%**)，但仍明显低于**CycleGPT-HyperTemp的55.80%**。

为了更深入理解**HyperTemp采样策略的特性与表现**，研究以CycleGPT为基础模型，分别替换为13种不同采样算法进行对比实验。结果(见补充表1)表明，当采用MaxEntropy或Noised Top-K算法时，模型在各项指标上均出现**断崖式下降**。总体来看，在novel_unique_macrocycles指标上，HyperTemp采样算法的表现**优于所有对比算法**。

进一步的分析揭示了HyperTemp采样对生成Token分布的影响。如图2a–c所示，HyperTemp通过基于温度采样的**精细概率调节**，有效降低对高概率Token的过度偏好，并增强对次优Token的探索，从而促进采样多样性并提升生成分子的**结构新颖性**。

此外，研究还基于MOSES指标体系，对不同方法生成的大环分子进行了系统评估，排除了novel_unique_macrocycles低于20%的模型。由于对比方法众多且差异细微，文中仅列出每项性质的前三名结果(见补充表2–3)。在10项评估指标中，**CycleGPT结合HyperTemp或Top-p采样**在6项中进入前三，整体性能**优于所有其他模型**。

从分子性质分布分析(补充图1–3)来看，CycleGPT-HyperTemp生成的大环分子与训练数据在化学性质上**分布高度一致**，说明模型不仅具备高生成有效性，也能保持分子性质的合理性与多样性。

为了进一步验证该方法在下游任务中的实用性，研究以大环化合物**Lorlatinib**为例，利用CycleGPT-HyperTemp扩展其化学空间。生成分子的可视化结果如图2d所示。经过Lorlatinib特定微调后，模型生成的分子**准确迁移至Lorlatinib邻域化学空间**，展示了CycleGPT在化学空间探索中的可靠性。

更为重要的是，CycleGPT-HyperTemp能够实现两类典型的**大环结构修饰功能**：

1. **大环骨架跃迁(macrocyclic scaffold hopping)**；
2. **外围取代基修饰(peripheral substituent modifications)**。

这些修饰方式与药物化学中的常见结构优化策略高度一致，充分证明了CycleGPT-HyperTemp在**大环分子结构优化中的实用性与化学可解释性**。

![](https://cdn.molastra.com/weixin/2025/10/11/19f76ea5c5af355fa66986f0651a0c74.jpg)

**图2｜HyperTemp采样行为与CycleGPT-HyperTemp在Lorlatinib化学空间中的探索** (a) 与(b) 分别展示了在与基础温度采样(Tempered sampling)对比时，**次优Token与最优Token生成概率变化的分布**。其中，最优Token定义为在每次生成中具有最高生成概率的Token，次优Token则为概率排名第二的Token。百分比变化的计算方式为：HyperTemp采样的Token概率减去Tempered采样的对应概率，再除以后者的概率值。(c) 展示了**在共30,000个生成SMILES中，Tempered采样与HyperTemp采样所生成Token的排序分布**。结果表明，在HyperTemp采样中，最优Token的采样频率明显下降，而次优Token的采样频率上升。这说明HyperTemp采样相较于传统温度采样，**能够更有效地扩展对次优Token的探索空间**，这一特性对于提升生成分子的结构新颖性至关重要。(d) 展示了以Lorlatinib为例的**化学空间UMAP可视化结果**。在Lorlatinib迁移学习完成后，随机选取1000个生成分子进行分析。图中展示了部分代表性分子的化学结构及其**结构修饰模式**：蓝色圈标示的为**大环骨架跃迁(macrocyclic scaffold hopping)**，红色圈标示的为**外围取代基修饰(peripheral substituent modifications)**。这些生成结构体现了CycleGPT-HyperTemp在**模拟药物化学家常用的分子修饰方式**方面的能力与准确性。

### 2.3 利用CycleGPT对JAK2大环抑制剂进行结构改造

Janus激酶(JAKs)是一类胞内酪氨酸激酶家族，在多种细胞因子信号传导中起关键作用，并与**骨髓增生性肿瘤、类风湿性关节炎**等多种疾病的发病机制密切相关。此前的研究中，团队基于**Macformer模型**通过对Fedratinib进行大环化改造，设计了三种JAK2大环抑制剂，其中化合物M3（为便于表述重新命名）表现出良好的药物开发潜力。

在药物研发过程中，开发**替代候选化合物**是一种降低风险、确保项目持续性的有效策略。因此，该研究进一步利用**CycleGPT模型**探索这三种大环JAK2抑制剂的**邻域化学空间**，以发现潜在的替代药物候选物。研究首先对三种大环JAK2抑制剂进行了**十倍随机SMILES增强**，并以此微调CycleGPT模型，使其迁移至特定化学空间。随后在推理阶段采用**HyperTemp采样算法**，共生成**5058个分布于起始分子邻域的大环化合物**。这一结果表明，CycleGPT-HyperTemp能够**准确学习并探索JAK2大环化合物的化学空间**(见图1d)。

为进一步筛选并丰富CycleGPT生成的大环分子，研究引入了**CyclePred模型**——一种异质图Transformer结构，用于预测JAK2抑制活性(见图3a)。CyclePred在5次五折交叉验证中的RMSE值为**0.6717**，而在预测非训练集的JAK2大环分子时降低至**0.5776**（数值越低表示预测性能越好）。模型预测的pIC₅₀值与实验数据的相关性良好，决定系数$R^2$达到**0.7036**(见图3c)，表明其具备较高的活性预测精度。

在CyclePred预测得到的活性评分中，选取前**70个宏环分子**分别使用**Glide**与**Rosetta**软件进行分子对接模拟。所用蛋白结构为来自PDB数据库的**Fedratinib–JAK2激酶结构复合物(编号6VNE)**。根据对接结果(图3d)及药物化学家的合成经验，最终筛选出**6个大环化合物**(图3e)进行化学合成(详见补充图5–19)及**生物活性评估**。

其与靶点的分子结合模式通过**ChimeraX**可视化(补充图4)，结果显示，这些大环化合物均能与JAK2激酶活性位点形成良好的**相互作用与空间匹配**，验证了CycleGPT在**大环药物结构优化与候选生成**中的实用性与科学性。

![](https://cdn.molastra.com/weixin/2025/10/11/e0477daa6e28a74e4deb949b8049717c.jpg)

**图3｜CyclePred预测JAK2抑制剂活性的流程与所筛选6种大环化合物的体外活性表现** (a) **CyclePred的整体工作流程图**，展示了从数据输入、特征提取、模型预测到活性筛选的完整步骤。(b) **JAK2抑制剂活性数据分布饼图**，显示了所收集的化合物在不同活性区间的比例情况。(c) **CyclePred在大环化合物数据集上的$R^2$性能评估结果**（测试集与验证集），表明模型在JAK2大环分子活性预测中具有较高的拟合精度与泛化能力。(d) **前70个预测活性最高的大环化合物的分子对接得分散点图**，结果来自Maestro Prime与Rosetta两种分子对接工具。图中包含6个实际合成的大环分子及其他候选分子；其中6个未能成功对接的分子被排除。(e) **成功合成的6个大环化合物的化学结构式**，用于后续实验验证。(f) **化合物1–6的体外JAK2抑制活性测试结果**。数据以**平均值±标准差(mean ± SD)形式表示，每组实验均重复三次。结果显示部分生成化合物在酶水平上具有强效抑制活性**，验证了CycleGPT与CyclePred联合设计的有效性。

### 2.4 所设计JAK2大环抑制剂的生物活性评估

研究利用**Z’-LYTE™激酶检测试剂盒**对所设计的六种大环化合物进行了激酶抑制活性测定，以此前研究获得的化合物M3和临床药物Fedratinib作为阳性对照(图3f与补充图21)。结果显示，其中**三种大环化合物展现出纳摩尔级别的JAK2抑制活性**，表现出显著的效能。其中，**化合物2的IC₅₀值仅为1.17 nM**，其抑制活性**优于Fedratinib**。

进一步地，这些化合物还在携带**JAK2 V617F突变**的人源红白血病细胞(HEL)与原发性血小板增多症细胞(SET-2)中进行了抗增殖活性测试(图3f)。结果显示，**化合物2对HEL与SET-2细胞均具有显著的抗增殖作用**，其机制为**剂量依赖性抑制JAK2-STAT信号通路**(图4a与补充图22)。

在激酶谱选择性方面，**化合物2的选择性明显优于Fedratinib与Pacritinib**(图4b)。当浓度为100 nM时，化合物2仅抑制**17种野生型激酶**(控制率<35%)，而Pacritinib与Fedratinib分别抑制**55种**与**34种激酶**。Fedratinib的激酶选择性数据可参考此前研究成果。

基于化合物2优异的体外抑制活性与激酶谱表现，研究进一步进行了**体内药效验证实验**。已有研究表明，给予实验鼠重组促红细胞生成素(rhEPO)可模拟人类真性红细胞增多症(PV)的主要症状，包括网织红细胞计数与红细胞比容升高、脾脏髓外造血导致的脾肿大等。

实验中，BALB/c小鼠每日皮下注射10单位rhEPO，同时每日经口给予**化合物2(剂量25、50、75 mg/kg)或溶媒，连续4天。与对照组相比，rhEPO模型组表现出明显的红系扩增——网织红细胞与红细胞比容升高、脾与骨髓中Ter119/CD71阳性红系祖细胞扩增、脾脏肿大。令人振奋的是，化合物2显著抑制了rhEPO诱导的红细胞比容上升、网织红细胞增多及脾肿大(图4c–f)，其中100 mg/kg剂量的化合物2效果与120 mg/kg的Fedratinib相当，且优于Pacritinib**。

此外，化合物2还能有效抑制脾与骨髓中**Ter119/CD71阳性红系细胞的异常扩增**(图4g、h与补充图20、23a–b)，但对**白细胞计数与体重**无显著影响(图4i与补充图23c)。

综合来看，这些结果充分表明，**化合物2不仅具有强效且高选择性的JAK2抑制活性**，还在动物模型中展现出**显著的体内治疗潜力**，为**真性红细胞增多症(polycythemia)**的治疗提供了有希望的新候选药物。

![](https://cdn.molastra.com/weixin/2025/10/11/91d8032325ddd148c9436afbf176ccc1.jpg)

**图4｜化合物2显著抑制JAK2信号通路，并在BALB/c小鼠中有效缓解rhEPO诱导的红细胞增多症与脾肿大** (a) **Western blot检测结果**：显示化合物2对JAK2(Y1007/8)、STAT3、STAT5、AKT及ERK磷酸化水平的抑制作用，证明其可有效阻断JAK2介导的信号传导。(b) **激酶选择性谱**：比较Pacritinib与化合物2在468种激酶中的抑制情况。结果表明，化合物2具有**更高的靶向选择性**。(c) **脾脏代表性照片**：展示各组小鼠脾脏大小差异。(d) **脾脏重量统计图**：化合物2显著减轻rhEPO诱导的脾肿大。(e) **红细胞比容(Hematocrit)**：化合物2有效降低因rhEPO导致的红细胞比容升高。(f) **网织红细胞计数(Reticulocyte count)**：显示化合物2可显著抑制红细胞过度生成。(g) **脾脏中Ter119/CD71阳性红系细胞群体分析**：表明化合物2抑制脾内异常红系扩增。(h) **骨髓中Ter119/CD71阳性红系细胞群体分析**：化合物2同样有效抑制骨髓中红系细胞扩张。(i) **体重变化**：化合物2处理组未出现显著体重波动，提示其毒性较低。

## 3 讨论

大环化合物是一类极具潜力的药物分子，其独特性质能够**弥补小分子药物设计中的诸多不足**。在药物研究中，对具有优越活性的“大环先导化合物”进行结构修饰，是发现新药的重要途径。为更高效地实现大环结构的优化与创新，该研究提出了**CycleGPT模型**，通过**渐进式迁移学习策略**，将“大环结构修饰问题”转化为“**大环化学空间探索问题**”。

针对这一目标，研究设计了创新的**HyperTemp采样算法**，用于提升生成大环分子的多样性与质量。CycleGPT与HyperTemp算法的结合，使模型能够实现包括**大环骨架跃迁(macrocyclic scaffold hopping)与环上取代基修饰**在内的结构变换方式，这与药物化学家的常规结构优化思路高度一致。

在CycleGPT-HyperTemp生成的分子中，研究基于**JAK2活性预测结果与分子对接评分**筛选出六种候选化合物用于合成与实验验证。后续的生物学测试显示，**化合物1、2与6在酶水平与细胞水平均表现出显著的JAK2抑制活性**，其中**化合物2在468种激酶的谱系中展现出优于Pacritinib与Fedratinib的高选择性特征**。此外，化合物2在体内实验中表现出**治疗真性红细胞增多症的潜力**。

这一前瞻性研究案例充分证明了**CycleGPT结合HyperTemp采样算法在探索大环化学空间方面的实用性与科学价值**，不仅能够生成具备药理相关性的创新结构，还能为**JAK2靶向治疗**提供新的候选化合物。展望未来，CycleGPT有望成为当前计算药物设计方法的**重要延伸与升级**，为**高效探索与修饰新兴大环候选化合物**提供强有力的AI工具。